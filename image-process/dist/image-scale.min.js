/*!
 * image-process v0.0.2
 * (c) 2017-2017 dailc
 * Released under the MIT License.
 * https://github.com/dailc/image-process
 */
!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):t.ImageScale=i()}(this,function(){"use strict";function t(t,i){return function(t,i,a,e,r,o){for(var n=r/i,h=o/a,f=e,d=function(e,o){var d=Math.min(i-1,e/n),c=Math.min(a-1,o/h),v=Math.floor(d),u=Math.floor(c),g=o*r+e,m=u*i+v;g*=4,m*=4;for(var s=0;s<=3;s+=1)f[g+s]=t[m+s]},c=0;c<r;c+=1)for(var v=0;v<o;v+=1)d(c,v)}(t.data,t.width,t.height,i.data,i.width,i.height),i}function i(t,i,a,e,r){var o=e,n=r;o>=a?o=a-1:o<0&&(o=0),n>=i?n=i-1:n<0&&(n=0);var h=o*i+n;return h*=4,[t[h+0],t[h+1],t[h+2],t[h+3]]}function a(t,a){return function(t,a,e,r,o,n){for(var h=o/a,f=n/e,d=r,c=function(r,n){var c=Math.min(a-1,r/h),v=Math.min(e-1,n/f),u=Math.floor(c),g=Math.floor(v),m=c-u,s=v-g,l=1-m,w=1-s,M=n*o+r;M*=4;for(var p=i(t,a,e,g+0,u+0),x=i(t,a,e,g+0,u+1),R=i(t,a,e,g+1,u+0),S=i(t,a,e,g+1,u+1),I=0;I<=3;I+=1){var y=s*(l*R[I]+m*S[I]),k=w*(l*p[I]+m*x[I]);d[M+I]=y+k}},v=0;v<o;v+=1)for(var u=0;u<n;u+=1)c(v,u)}(t.data,t.width,t.height,a.data,a.width,a.height),a}function e(t,i){return function(t,i,a,e,r,o){for(var n=e,h=r/i,f=o/a,d=function(e,o){var d=Math.min(i-1,e/h),c=Math.min(a-1,o/f),v=Math.floor(d),u=Math.floor(c),g=d-v,m=c-u,s=o*r+e;s*=4;for(var l=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],w=0;w<=3;w+=1){for(var M=-1;M<=2;M+=1)for(var p=-1;p<=2;p+=1)l[M+1][p+1]=k(t,i,a,u+M,v+p,w);D(l),n[s+w]=P(b(m,g))}},c=0;c<r;c+=1)for(var v=0;v<o;v+=1)d(c,v)}(t.data,t.width,t.height,i.data,i.width,i.height),i}function r(t){var i=t>=0?t:-t,a=t*t,e=i*a;return i<=1?1-(W+3)*a+(W+2)*e:i<=2?-4*W+8*W*i-5*W*a+W*e:0}function o(t){var i=t;return i=Math.min(255,i),i=Math.max(0,i)}function n(t,i,a,e,r){var o=e,n=r;o>=a?o=a-1:o<0&&(o=0),n>=i?n=i-1:n<0&&(n=0);var h=o*i+n;return h*=4,[t[h+0],t[h+1],t[h+2],t[h+3]]}function h(t,i){return function(t,i,a,e,h,f){for(var d=e,c=h/i,v=f/a,u=function(e,f){var u=Math.min(i-1,e/c),g=Math.min(a-1,f/v),m=Math.floor(u),s=Math.floor(g),l=u-m,w=g-s,M=f*h+e;M*=4;for(var p=[0,0,0,0],x=-1;x<=2;x+=1)for(var R=-1;R<=2;R+=1){var S=n(t,i,a,s+x,m+R),I=r(x-w)*r(R-l);p[0]+=S[0]*I,p[1]+=S[1]*I,p[2]+=S[2]*I,p[3]+=S[3]*I}d[M+0]=o(p[0]),d[M+1]=o(p[1]),d[M+2]=o(p[2]),d[M+3]=o(p[3])},g=0;g<h;g+=1)for(var m=0;m<f;m+=1)u(g,m)}(t.data,t.width,t.height,i.data,i.width,i.height),i}function f(t){for(var i=t,a=arguments.length,e=Array(a>1?a-1:0),r=1;r<a;r++)e[r-1]=arguments[r];return e.forEach(function(t){t&&Object.keys(t).forEach(function(a){i[a]=t[a]})}),i}var d=void 0,c=void 0,v=void 0,u=void 0,g=void 0,m=void 0,s=void 0,l=void 0,w=void 0,M=void 0,p=void 0,x=void 0,R=void 0,S=void 0,I=void 0,y=void 0,k=function(t,i,a,e,r,o){var n=e,h=r;n>=a?n=a-1:n<0&&(n=0),h>=i?h=i-1:h<0&&(h=0);var f=n*i+h;return f*=4,t[f+o]},P=function(t){var i=t;return i=Math.min(255,i),i=Math.max(0,i)},D=function(t){var i=t;d=i[1][1],c=-.5*i[1][0]+.5*i[1][2],v=i[1][0]-2.5*i[1][1]+2*i[1][2]-.5*i[1][3],u=-.5*i[1][0]+1.5*i[1][1]-1.5*i[1][2]+.5*i[1][3],g=-.5*i[0][1]+.5*i[2][1],m=.25*i[0][0]-.25*i[0][2]-.25*i[2][0]+.25*i[2][2],s=-.5*i[0][0]+1.25*i[0][1]-i[0][2]+.25*i[0][3]+.5*i[2][0]-1.25*i[2][1]+i[2][2]-.25*i[2][3],l=.25*i[0][0]-.75*i[0][1]+.75*i[0][2]-.25*i[0][3]-.25*i[2][0]+.75*i[2][1]-.75*i[2][2]+.25*i[2][3],w=i[0][1]-2.5*i[1][1]+2*i[2][1]-.5*i[3][1],M=-.5*i[0][0]+.5*i[0][2]+1.25*i[1][0]-1.25*i[1][2]-i[2][0]+i[2][2]+.25*i[3][0]-.25*i[3][2],p=i[0][0]-2.5*i[0][1]+2*i[0][2]-.5*i[0][3]-2.5*i[1][0]+6.25*i[1][1]-5*i[1][2]+1.25*i[1][3]+2*i[2][0]-5*i[2][1]+4*i[2][2]-i[2][3]-.5*i[3][0]+1.25*i[3][1]-i[3][2]+.25*i[3][3],x=-.5*i[0][0]+1.5*i[0][1]-1.5*i[0][2]+.5*i[0][3]+1.25*i[1][0]-3.75*i[1][1]+3.75*i[1][2]-1.25*i[1][3]-i[2][0]+3*i[2][1]-3*i[2][2]+i[2][3]+.25*i[3][0]-.75*i[3][1]+.75*i[3][2]-.25*i[3][3],R=-.5*i[0][1]+1.5*i[1][1]-1.5*i[2][1]+.5*i[3][1],S=.25*i[0][0]-.25*i[0][2]-.75*i[1][0]+.75*i[1][2]+.75*i[2][0]-.75*i[2][2]-.25*i[3][0]+.25*i[3][2],I=-.5*i[0][0]+1.25*i[0][1]-i[0][2]+.25*i[0][3]+1.5*i[1][0]-3.75*i[1][1]+3*i[1][2]-.75*i[1][3]-1.5*i[2][0]+3.75*i[2][1]-3*i[2][2]+.75*i[2][3]+.5*i[3][0]-1.25*i[3][1]+i[3][2]-.25*i[3][3],y=.25*i[0][0]-.75*i[0][1]+.75*i[0][2]-.25*i[0][3]-.75*i[1][0]+2.25*i[1][1]-2.25*i[1][2]+.75*i[1][3]+.75*i[2][0]-2.25*i[2][1]+2.25*i[2][2]-.75*i[2][3]-.25*i[3][0]+.75*i[3][1]-.75*i[3][2]+.25*i[3][3]},b=function(t,i){var a=t*t,e=i*i,r=e*i;return d+c*i+v*e+u*r+(g+m*i+s*e+l*r)*t+(w+M*i+p*e+x*r)*a+(R+S*i+I*e+y*r)*(a*t)},W=-1,B={width:80,height:80,mime:"image/png",processType:1},E={quality:.92,mime:"image/jpeg",compressScaleRatio:1,iphoneFixedRatio:1.5,isUseOriginSize:!1,maxWidth:0,forceWidth:0,forceHeight:0},O={};return function(i){var r=i;r.scaleImageData=function(i,r,o){(0,[t,a,e,h][f({},B,o).processType])(i,r)},r.scaleImage=function(t,i){var a=t.width,e=t.height,o=f({},B,i),n=document.createElement("canvas"),h=n.getContext("2d");n.width=a,n.height=e,h.drawImage(t,0,0,a,e);var d=h.getImageData(0,0,a,e),c=h.createImageData(o.width,o.height);return r.scaleImageData(d,c,o),n.width=c.width,n.height=c.height,h.putImageData(c,0,0,0,0,n.width,n.height),n.toDataURL(o.mime,.9)},r.compressImage=function(t,i){var a=t.width,e=t.height,r=a/e,o=f({},E,i),n=document.createElement("canvas"),h=n.getContext("2d"),d=function(t){var i=t.backingStorePixelRatio||t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/i}(h);d*=o.compressScaleRatio||1,navigator.userAgent.match(/(iPhone\sOS)\s([\d_]+)/)&&(d*=o.iphoneFixedRatio||1);var c=window.innerWidth*d;(o.isUseOriginSize||c>a)&&(c=a);var v=o.maxWidth;v&&a>v&&c>v&&(c=v);var u=o.forceWidth,g=o.forceHeight;u&&(c=u);var m=c/r;return g&&(m=g),n.width=c,n.height=m,h.drawImage(t,0,0,a,e,0,0,n.width,n.height),n.toDataURL(o.mime,o.quality)}}(O),O});